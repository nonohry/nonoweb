{% assign page_paginator = include.paginator %}
{% if page_paginator %}
  {% assign posts_to_render = page_paginator.posts %}
{% else %}
  {% assign posts_to_render = site.posts %}
{% endif %}

<div class="articles">
  {% for post in posts_to_render %}
    {% cycle 'row-open' : '<div class="row">', '', '' %}
    <div class="four columns">
      <a href="{{ site.baseurl }}{{ post.url }}" class="link">
        <h3>{{ post.title }}</h3>
        <div class="justify">
          {% if post.abstract %}
            {{ post.abstract }}
          {% else %}
            {{ post.content | strip_html | truncatewords: 50 | strip_newlines }}
          {% endif %}
        </div>
      </a>
    </div>
    {% cycle 'row-close' : '', '', '</div>' %}
  {% endfor %}
  {% cycle 'row-close' : '', '</div>', '</div>', '</div>' %}
</div>

{% if page_paginator %}
<nav class="pagination center" aria-label="Pagination">
  {% if page_paginator.previous_page_path %}
    <a class="btn" href="{{ page_paginator.previous_page_path | prepend: site.baseurl }}">← Newer</a>
  {% endif %}

  {% if page_paginator.page_trail %}
    {% for node in page_paginator.page_trail %}
      <a class="btn {% if node.num == page_paginator.page %}active{% endif %}"
         href="{{ node.path | prepend: site.baseurl }}"
         title="{{ node.title }}">
        {{ node.num }}
      </a>
    {% endfor %}
  {% else %}
    <span class="page-number">Page {{ page_paginator.page }} of {{ page_paginator.total_pages }}</span>
  {% endif %}

  {% if page_paginator.next_page_path %}
    <a class="btn" href="{{ page_paginator.next_page_path | prepend: site.baseurl }}">Older →</a>
  {% endif %}
</nav>
{% endif %}
